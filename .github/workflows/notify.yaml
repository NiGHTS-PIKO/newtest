name: Notify Raspberry Pi

on:
  push:
    branches:
      - master  # または 'main' に変更してください

jobs:
  send-webhook:
    runs-on: [self-hosted, ARM64, Linux]
    steps:
      - name: 🔧 Install Tailscale
        run: |
          curl -fsSL https://tailscale.com/install.sh | sh
          sudo tailscale up --authkey ${{ secrets.TS_AUTHKEY }}

      - name: 📡 Send webhook to Raspberry Pi
        run: |
          curl -X POST -H "Content-Type: application/json" \
               -d '{"event": "push", "repo": "${{ github.repository }}", "author": "${{ github.actor }}"}' \
               http://100.101.30.82:8080/webhook
